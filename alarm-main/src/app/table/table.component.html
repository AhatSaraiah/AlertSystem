
<div class="row">
  <div class="col-12">
    <table class="table  table-striped table-bordered table-hover">
      <thead>
      <tr>
        <th>מספר רכב</th>
        <th>שם הנהג\נגרר</th>
        <th>חידוש ביטוח </th>
        <th>תאריך לטסט </th>
        <th>חו''מס</th>
        <th> כיול טכוגרף</th>
        <th>קטגוריה</th>
        <th>סטטוס</th>
        <th>הערות</th>
        <th>עריכה</th>
        <th>מחיקה</th>
      </tr>
      </thead>
      <tbody>
        <tr *ngFor="let record of sortedData" [class.coming-soon]="comingSoon(record)">
          <td (dblclick)="onEdit(record,'carId')">
            <div class="row" *ngIf="record.editFieldName == 'carId'">
              <div class="col-9">
                <input type="text" [(ngModel)]="record.carId" class="form-control"/>
              </div>
              <div class="col-3 text-center">
                <i class="fa fa-check-circle-o" aria-hidden="true"></i>
                <i class="fa fa-times ml-2 " aria-hidden="true" (click)="close(record)"></i>
              </div>
            </div>
            <div *ngIf="record.editFieldName !== 'carId'">
              {{record.carId}}
            </div>
          </td>
          <td (dblclick)="onEdit(record,'driverName')">
            <div class="row" *ngIf="record.editFieldName == 'driverName'">
              <div class="col-9">
                <input type="text" [(ngModel)]="record.driverName" class="form-control"/>
              </div>
              <div class="col-3 text-center">
                <i class="fa fa-check-circle-o" aria-hidden="true"></i>
                <i class="fa fa-times ml-2 " aria-hidden="true" (click)="close(record)"></i>
              </div>
            </div>
            <div *ngIf="record.editFieldName !== 'driverName'">
              {{record.driverName}}
            </div>
          </td>
          <td (dblclick)="onEdit(record,'insuranceDate')">
            <div *ngIf="record.editFieldName == 'insuranceDate'">
              <input type="text" [(ngModel)]="record.insuranceDate" class="form-control"/>
            </div>
            <div *ngIf="record.editFieldName !== 'insuranceDate'">
              {{record.insuranceDate}}
            </div>
          </td>
          <td (dblclick)="onEdit(record,'testDate')">
            <div *ngIf="record.editFieldName == 'testDate'">
              <input type="text" [(ngModel)]="record.testDate" class="form-control"/>
            </div>
            <div *ngIf="record.editFieldName !== 'testDate'">
              {{record.testDate}}     
            </div>
          </td>
          <td (dblclick)="onEdit(record,'riskMatDate')">
            <div *ngIf="record.editFieldName == 'riskMatDate'">
              <input type="text" [(ngModel)]="record.riskMatDate" class="form-control"/>
            </div>
            <div *ngIf="record.editFieldName !== 'riskMatDate'">
              {{record.riskMatDate}}
            </div>
          </td>
          <td (dblclick)="onEdit(record,'weight')">
            <div *ngIf="record.editFieldName == 'weight'">
              <input type="text" [(ngModel)]="record.weight" class="form-control"/>
            </div>
            <div *ngIf="record.editFieldName !== 'weight'">
              {{record.weight}}
            </div>
          </td>
          <td (dblclick)="onEdit(record,'category')">
            <div *ngIf="record.editFieldName == 'category'">
              <input type="text" [(ngModel)]="record.category" class="form-control"/>
            </div>
            <div *ngIf="record.editFieldName !== 'category'">
              {{record.category}}
            </div>
          </td>

          <td class="status" (dblclick)="onEdit(record,'status')" [ngClass]="{ 'flick': isExpired(record) }">
            <div *ngIf="record.editFieldName == 'status'">
              <input type="text" [(ngModel)]="record.status" class="form-control"/>
            </div>
            <div *ngIf="record.editFieldName !== 'status'">
              {{record.status}}
            </div>
          </td>
        
          <td (dblclick)="onEdit(record,'note')">
            <div *ngIf="record.editFieldName == 'note'">
              <input type="text" [(ngModel)]="record.note" class="form-control"/>
            </div>
            <div *ngIf="record.editFieldName !== 'note'">
              {{record.note}}
            </div>
          </td>
          <td>
            <button  id = "update" [disabled]="isDisable" (click)="updateLocalStorage(record)">עדכן</button>
          </td>
          <td>
            <button id = "delete" [disabled]="isDisable" (click)="deleteRow(record)">מחק</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
<input type="file" (change)="handleFileInput($event)">
<button class="btn btn-primary" (click)="downloadExcel()">שמירת קובץ</button><br/>
<button (click)="addRow()">הוספת שורה</button>


