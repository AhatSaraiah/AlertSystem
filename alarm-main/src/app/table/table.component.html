
<div class="row">
  <div class="col-12">
    <table class="table  table-striped table-bordered table-hover">
      <thead>
      <tr>
        <th>מספר רכב</th>
        <th>תאריך רשיון</th>
        <th>תאריך טסט </th>
        <th>חו''מס</th>
        <th>כיול</th>
        <th>קטגוריה</th>
        <th>סטטוס</th>
        <th>הערות</th>
        <th>מחיקת שורה</th>
        <th>עדכון</th>
      </tr>
      </thead>
      <tbody>
        <tr *ngFor="let record of sortedData" [class.coming-soon]="comingSoon(record)">
          <td (dblclick)="onEdit(record,'carId')">
            <div class="row" *ngIf="record.editFieldName == 'carId'">
              <div class="col-9">
                <input type="text" [(ngModel)]="record.carId" class="form-control"/>
              </div>
              <div class="col-3 text-center">
                <i class="fa fa-check-circle-o" aria-hidden="true"></i>
                <i class="fa fa-times ml-2 " aria-hidden="true" (click)="close(record)"></i>
              </div>
            </div>
            <div *ngIf="record.editFieldName !== 'carId'">
              {{record.carId}}
            </div>
          </td>
          <td (dblclick)="onEdit(record,'licenseDate')">
            <div *ngIf="record.editFieldName == 'licenseDate'">
              <input type="text" [(ngModel)]="record.licenseDate" class="form-control"/>
            </div>
            <div *ngIf="record.editFieldName !== 'licenseDate'">
              {{record.licenseDate}}
            </div>
          </td>
          <td (dblclick)="onEdit(record,'testDate')">
            <div *ngIf="record.editFieldName == 'testDate'">
              <input type="text" [(ngModel)]="record.testDate" class="form-control"/>
            </div>
            <div *ngIf="record.editFieldName !== 'testDate'">
              {{record.testDate}}     
            </div>
          </td>
          <td (dblclick)="onEdit(record,'riskMatDate')">
            <div *ngIf="record.editFieldName == 'riskMatDate'">
              <input type="text" [(ngModel)]="record.riskMatDate" class="form-control"/>
            </div>
            <div *ngIf="record.editFieldName !== 'riskMatDate'">
              {{record.riskMatDate}}
            </div>
          </td>
          <td (dblclick)="onEdit(record,'weight')">
            <div *ngIf="record.editFieldName == 'weight'">
              <input type="text" [(ngModel)]="record.weight" class="form-control"/>
            </div>
            <div *ngIf="record.editFieldName !== 'weight'">
              {{record.weight}}
            </div>
          </td>
          <td (dblclick)="onEdit(record,'category')">
            <div *ngIf="record.editFieldName == 'category'">
              <input type="text" [(ngModel)]="record.category" class="form-control"/>
            </div>
            <div *ngIf="record.editFieldName !== 'category'">
              {{record.category}}
            </div>
          </td>

          <td class="status" (dblclick)="onEdit(record,'status')" [ngClass]="{ 'flick': isExpired(record) }">
            <div *ngIf="record.editFieldName == 'status'">
              <input type="text" [(ngModel)]="record.status" class="form-control"/>
            </div>
            <div *ngIf="record.editFieldName !== 'status'">
              {{record.status}}
            </div>
          </td>
        
          <td (dblclick)="onEdit(record,'note')">
            <div *ngIf="record.editFieldName == 'note'">
              <input type="text" [(ngModel)]="record.note" class="form-control"/>
            </div>
            <div *ngIf="record.editFieldName !== 'note'">
              {{record.note}}
            </div>
          </td>
          <!-- Add delete button here -->
          <td>
            <button [disabled]="isDisable" (click)="deleteRow(record)">מחק</button>
          </td>
          <td>
            <button [disabled]="isDisable" (click)="updateLocalStorage(record)">עדכן</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
<input type="file" (change)="handleFileInput($event)">
<button (click)="addRow()">הוסף שורה</button>
<button class="btn btn-primary" (click)="downloadExcel()">שמירת קובץ</button>

